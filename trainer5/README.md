copied from trainer4 and override train_step eval cannot restore decoder components